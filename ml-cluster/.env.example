# =============================================================================
# Intel Desk - ML Cluster Service Environment Variables
# =============================================================================
# Copy this file to .env and fill in your values:
#   cp .env.example .env
# =============================================================================

# -----------------------------------------------------------------------------
# Supabase
# -----------------------------------------------------------------------------
# Must point to the SAME Supabase project used by the Next.js app.
# Find these values in: Project Settings > API
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_SECRET_KEY=sb_secret_your-key

# Direct PostgreSQL connection string for the ML service to read/write data.
# Found in: Project Settings > Database > Connection string (URI format).
# Replace "your-project", "your-password", and "region" with your actual values.
DATABASE_URL=postgresql://postgres.your-project:your-password@aws-0-region.pooler.supabase.com:5432/postgres

# -----------------------------------------------------------------------------
# Flask
# -----------------------------------------------------------------------------
# Server environment. Set to "production" when deploying.
FLASK_ENV=development

# Enable debug mode (hot-reload, verbose errors). Set to 0 in production.
FLASK_DEBUG=1

# Port the Flask server listens on. Make sure it does not conflict with
# the Next.js dev server (default 3000).
PORT=5001

# -----------------------------------------------------------------------------
# ML Config
# -----------------------------------------------------------------------------
# Sentence-Transformers model used to generate text embeddings for clustering.
# The default multilingual model works well across English, Spanish, French,
# Arabic, Chinese, and many other languages.
# Browse alternatives at https://www.sbert.net/docs/pretrained_models.html
EMBEDDING_MODEL=paraphrase-multilingual-MiniLM-L12-v2

# HDBSCAN clustering parameters.
# MIN_CLUSTER_SIZE  - Minimum number of articles to form a cluster.
# MIN_SAMPLES       - How conservative clustering is (higher = fewer clusters).
# Tune these based on your ingestion volume.
MIN_CLUSTER_SIZE=2
MIN_SAMPLES=1

# Cosine-similarity threshold used to assign new articles to existing clusters.
# Range 0-1. Higher values require articles to be more similar before merging.
SIMILARITY_THRESHOLD=0.75

# Cosine-similarity threshold for near-duplicate detection.
# Articles above this threshold are flagged as duplicates and deduplicated.
DEDUP_THRESHOLD=0.92

# -----------------------------------------------------------------------------
# OpenAI (optional)
# -----------------------------------------------------------------------------
# When provided, GPT is used to generate human-readable cluster titles,
# summaries, and enrichment metadata. Without it, the service falls back
# to extractive methods (keyword-based titles, leading-sentence summaries).
# Get your API key at https://platform.openai.com/api-keys
OPENAI_API_KEY=sk-proj-your-openai-key
